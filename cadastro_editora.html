<html>
    <head>
        <title>
            Cadastro de editora
        </title>     
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    </head>
        
    <body>

        <h1>Cadastro de editora</h1>
        <br>

        Id:
        <br>
        <input type="text" id="id">
        <br><br>

        Nome:
        <br>
        <input type="text" id="nome">
        <br><br>

        Fundacao:
        <br>
        <input type="text" id="fundacao">
        <br><br>

        Estado:
        <br>
        <input type="text" id="estado">
        <br><br>

        Pais:
        <br>
        <input type="text" id="pais">
        <br><br>

        <button onclick="inserir()">Salvar</button>

        <a href="editoras.html">
            <button>Voltar</button>
        </a>        

    </body>
</html>

<!-- 
    Aqui abaixo nós colocamos
    o código javascript para construir o JSON
    e enviá-lo a API
-->

<script language="javascript">
    function inserir(){

        //Criando variáveis com os dados obtidos
        //nos campos do formulário no HTML
        var id = document.getElementById("id").value
        var nome = document.getElementById("nome").value
        var fundacao = document.getElementById("fundacao").value
        var estado = document.getElementById("estado").value
        var pais = document.getElementById("pais").value

        //Construindo o JSON que será
        //enviado para a API
        var json = {
            'id': id,
            'nome': nome,
            'fundacao': fundacao,
            'estado': estado,
            'pais': pais
        }

        //Enviando para a API o json 
        //construído na etapa anterior
        fetch('http://127.0.0.1:5000/editora/inserir',
        {
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            method: "POST",
            body: JSON.stringify(json)
        })
        .then(function(res){ 
            res.json()
                .then(data => {
                    console.log(data)
                    window.open("editoras.html");
                })
        })
        .catch(function(res){ console.log(res) })
    }
</script>